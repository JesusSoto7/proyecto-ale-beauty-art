<!-- Banner -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="background-color:#fb73a9;">
  <tr>
    <td align="center" style="padding:20px 0;">
      <img src="https://raw.githubusercontent.com/JesusSoto7/proyecto-ale-beauty-art/refs/heads/main/Backend/app/assets/images/ale_logo.jpg"
           width="80" height="80" alt="Ale Beauty Art"
           style="border-radius:50%; border:3px solid #fff; display:block;">
    </td>
  </tr>
  <tr>
    <td align="center">
      <svg viewBox="0 0 1440 320" width="100%" height="60" style="display:block;">
        <path fill="#ffffff" fill-opacity="1"
          d="M0,224L60,213.3C120,203,240,181,360,165.3C480,149,600,139,720,149.3C840,160,960,192,1080,192C1200,192,1320,160,1380,144L1440,128L1440,320L0,320Z" />
      </svg>
    </td>
  </tr>
</table>

<!-- Contenido principal -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="max-width:650px; margin:0 auto;">
  <tr>
    <td align="center" style="padding:20px;">
      <h1 style="margin:0; font-size:26px;">¡Pedido Exitoso!</h1>
      <p style="font-size:16px;">Hola <strong style="color:#fb73a9;"><%= @buyer_name %></strong>!</p>
      <p style="font-size:16px;">¡Gracias por tu compra!</p>
      <hr style="border:none; border-top:1px solid #ccc; width:100%;">
      <h2 style="font-size:18px; font-weight:normal;">
        Número de pedido:
        <strong style="color:#fb73a9;"><%= @numero %></strong>
      </h2>
    </td>
  </tr>
</table>

<!-- Datos del pedido -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="10" border="0" style="max-width:650px; margin:0 auto;">
  <tr>
    <td style="font-size:14px; color:#918f8f;">Este es tu pedido:</td>
  </tr>
  <tr>
    <td>
      <table role="presentation" width="100%" cellspacing="0" cellpadding="5" border="0">
        <tr>
          <td width="50%" valign="top">
            <strong style="color:#202020;">N. orden:</strong><br>
            <span style="color:#918f8f;"><%= @numero %></span><br><br>
            <strong style="color:#202020;">Fecha de pedido:</strong><br>
            <span style="color:#918f8f;"><%= (@order.created_at || Time.current).strftime("%d %b %Y") %></span>
          </td>
          <td width="50%" valign="top">
            <strong style="color:#202020;">Factura a:</strong><br>
            <span style="color:#918f8f;"><%= @buyer_email %></span><br><br>
            <strong style="color:#202020;">Fuente:</strong><br>
            <span style="color:#918f8f;">Ale Beauty Art</span>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>

<!-- Resumen de productos -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="5" border="0" style="max-width:650px; margin:10px auto; border-collapse:collapse; border:1px solid #ddd;">
  <tr style="background-color:#202020; color:#fff;">
    <th align="left" style="padding:8px;">Producto</th>
    <th align="center" style="padding:8px;">Cantidad</th>
    <th align="right" style="padding:8px;">Valor unitario</th>
  </tr>
  <% @order.order_details.each do |item| %>
    <% product_name = item.product&.nombre_producto || "Producto" %>
    <% unit_price   = item.precio_unitario.to_f %>
    <tr style="background-color:#fff;">
      <td style="padding:8px; border-top:1px solid #eee;"><%= product_name %></td>
      <td align="center" style="padding:8px; border-top:1px solid #eee;">x<%= item.cantidad %></td>
      <td align="right" style="padding:8px; border-top:1px solid #eee;">$ <%= number_with_precision(unit_price, precision: 0, delimiter: ".") %></td>
    </tr>
  <% end %>
</table>

<!-- Total -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="10" border="0" style="max-width:650px; margin:0 auto;">
  <tr>
    <td align="right" style="font-size:16px; font-weight:bold;">
      Total: $ <%= number_with_precision(@total, precision: 0, delimiter: ".") %>
    </td>
  </tr>
</table>